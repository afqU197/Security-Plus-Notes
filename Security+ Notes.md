# Security+ Notes

[**Domain 1: General Security Concepts 3**](about:blank#domain-1-general-security-concepts)

> Security Controls 3
> 
> 
> [Fundamental Security Concepts 4](about:blank#fundamental-security-concepts)
> 
> [Authentication, Authorization, Accounting or AAA 4](about:blank#authentication-authorization-accounting-or-aaa)
> 
> [Zero Trust 5](about:blank#zero-trust)
> 
> [Physical Security 5](about:blank#physical-security)
> 
> [Deception and Disruption Techniques 5](about:blank#deception-and-disruption-techniques)
> 
> [Change Management Operations 6](about:blank#change-management-operations)
> 
> [Change Management Technical Considerations 6](about:blank#change-management-technical-considerations)
> 
> [Documenting Changes 7](about:blank#documenting-changes)
> 
> [**Encryption 8**](about:blank#encryption)
> 
> [Encryption Types 8](about:blank#encryption-types)
> 
> [PKI Public Key Infrastructure 10](about:blank#pki-public-key-infrastructure)
> 
> [Encryption Tools 12](about:blank#encryption-tools)
> 
> [Cryptographic Solutions 12](about:blank#cryptographic-solutions)
> 

[**Domain 2: Threats, Vulnerabilities & Mitigations 13**](about:blank#domain-2-threats-vulnerabilities-mitigations)

> Attacks 13
> 
> 
> [Attacker Motivation: 14](about:blank#attacker-motivation)
> 
> [Attack Surfaces and Vectors 14](about:blank#attack-surfaces-and-vectors)
> 
> [Social Engineering 16](about:blank#social-engineering)
> 
> [Vulnerabilities and Attacks 16](about:blank#vulnerabilities-and-attacks)
> 
> [Vulnerabilities 16](about:blank#vulnerabilities)
> 
> [Application and Web Vulnerabilities 17](about:blank#application-and-web-vulnerabilities)
> 
> [Hardware and Virtualization Vulnerabilities 17](about:blank#hardware-and-virtualization-vulnerabilities)
> 
> [Malware Attacks 18](about:blank#malware-attacks)
> 
> [Physical and Network Attacks 19](about:blank#physical-and-network-attacks)
> 
> [Application Based Attacks 20](about:blank#application-based-attacks)
> 
> [Cryptographic and Password Attacks 20](about:blank#cryptographic-and-password-attacks)
> 
> [Indicators of compromise 21](about:blank#indicators-of-compromise)
> 
> [Mitigations and Hardening 21](about:blank#mitigations-and-hardening)
> 
> [Mitigation Techniques 21](about:blank#mitigation-techniques)
> 
> [Endpoint Mitigation and Protection 22](about:blank#endpoint-mitigation-and-protection)
> 
> [System Hardening Techniques 22](about:blank#system-hardening-techniques)
> 

[**Domain 3: Security Architecture 23**](about:blank#domain-3-security-architecture)

> Architecture and Infrastructure 23
> 
> 
> [Network Infrastructure 23](about:blank#network-infrastructure)
> 
> [Cloud Infrastructure 24](about:blank#cloud-infrastructure)
> 
> [Cloud Architecture 25](about:blank#cloud-architecture)
> 
> [Virtualization 25](about:blank#virtualization)
> 
> [IoT and ICS 26](about:blank#iot-and-ics)
> 
> [Architecture Considerations 27](about:blank#architecture-considerations)
> 
> [Infrastructure Considerations 27](about:blank#infrastructure-considerations)
> 
> [Network Security 28](about:blank#network-security)
> 
> [Secure Communications: 29](about:blank#secure-communications)
> 
> [Data Types 30](about:blank#data-types)
> 
> [Data Classification 30](about:blank#data-classification)
> 
> [Securing Data 31](about:blank#securing-data)
> 
> [Resilient Architecture 32](about:blank#resilient-architecture)
> 
> [Business Continuity 32](about:blank#business-continuity)
> 
> [Backups 33](about:blank#backups)
> 

[**Domain 4: Security Operations 1 34**](about:blank#domain-4-security-operations-1)

> Securing Systems 34
> 
> 
> [Embedded Systems Hardening 34](about:blank#embedded-systems-hardening)
> 
> [Wireless Security 35](about:blank#wireless-security)
> 
> [Mobile Security 36](about:blank#mobile-security)
> 
> [Application Security 37](about:blank#application-security)
> 
> [Asset Management 37](about:blank#asset-management)
> 
> [Identifying Vulnerabilities 38](about:blank#identifying-vulnerabilities)
> 
> [Vulnerability Analysis 39](about:blank#vulnerability-analysis)
> 
> [Response and Remediation 40](about:blank#response-and-remediation)
> 
> [Monitoring Systems 40](about:blank#monitoring-systems)
> 
> [Logging and Monitoring Tools 41](about:blank#logging-and-monitoring-tools)
> 
> [Securing with Firewalls 41](about:blank#securing-with-firewalls)
> 
> [Intrusion Detection and Prevention Systems 41](about:blank#intrusion-detection-and-prevention-systems)
> 
> [Security Protocol Implementation 42](about:blank#security-protocol-implementation)
> 
> [Network Access Control NAC 43](about:blank#network-access-control-nac)
> 
> [DNS Filtering 44](about:blank#dns-filtering)
> 

[**Domain 4: Security Operations II 44**](about:blank#domain-4-security-operations-ii)

> Endpoint Security Methods 44
> 
> 
> [Email Security 45](about:blank#email-security)
> 
> [Web Filtering 45](about:blank#web-filtering)
> 
> [Identity & Access Management 46](about:blank#identity-access-management)
> 
> [Federation and Single Sign- On 46](about:blank#federation-and-single-sign--on)
> 
> [Access Control Methods 47](about:blank#access-control-methods)
> 
> [Multi Factor Authentication MFA 48](about:blank#multi-factor-authentication-mfa)
> 
> [Password 49](about:blank#password)
> 
> [Privileged Access Management 49](about:blank#privileged-access-management)
> 
> [Automation and scripting 49](about:blank#automation-and-scripting)
> 
> [Incident Response Process 50](about:blank#incident-response-process)
> 
> [Incident Response Training and testing 51](about:blank#incident-response-training-and-testing)
> 
> [Digital Forensics 51](about:blank#digital-forensics)
> 
> [Log Data 51](about:blank#log-data)
> 

[**Domain 5: Security Program Management and Oversight 52**](about:blank#domain-5-security-program-management-and-oversight)

> Policies 52
> 
> 
> [Procedures 53](about:blank#procedures)
> 
> [Standards 53](about:blank#standards)
> 
> [Common Industry Standards 53](about:blank#common-industry-standards)
> 
> [Laws and Regulations 54](about:blank#laws-and-regulations)
> 
> [Governance 54](about:blank#governance)
> 
> [Risk Identification and assessment 55](about:blank#risk-identification-and-assessment)
> 
> [Risk Analysis 55](about:blank#risk-analysis)
> 
> [Risk Management 56](about:blank#risk-management)
> 
> [Business Impact Analysis BIA 56](about:blank#business-impact-analysis-bia)
> 
> [Vendor Selection and Assessment 57](about:blank#vendor-selection-and-assessment)
> 
> [Vendor Agreements 57](about:blank#vendor-agreements)
> 
> [Compliance Monitoring and Reporting 57](about:blank#compliance-monitoring-and-reporting)
> 
> [Non-Compliance Consequences 58](about:blank#non-compliance-consequences)
> 
> [Privacy 58](about:blank#privacy)
> 
> [Audits and Assessments 58](about:blank#audits-and-assessments)
> 
> [Penetration Testing 58](about:blank#penetration-testing)
> 
> [User Training 59](about:blank#user-training)
> 
> [Training Development and Execution 59](about:blank#training-development-and-execution)
> 

# Domain 1: General Security Concepts

## Security Controls

It can be procedures, activity, tool, design to protect the CIA triad of a system.

Examples: security software and hardware, written policies, cameras, gates

4 Categories:

- Technical: implemented as some type of system like hardware and software. Ex: firewall, antivirus, encryption, IPS, ACL
- Managerial: control the oversight of the security programs, ex: risk assessment programs, tools to identify risks, evaluate controls, security policies
- Operational: category implemented by a person instead of a system, with managerial control it can be called administrative controls. Ex: security guards, training programs.
- Physical: provide security for structures and areas, ex: security alarms, locked doors, security lighting

Control types

- Preventive: reduce or eliminate the likelihood of a attack, operates before the attack, ACLs
- Deterrent: discourage the attacker of attempting an attack, may not prevent
- Detective: identify and record attempted and successful attacks, also dont prevent.
- Corrective: reduce or eliminate the effect and impact of an attack, backup, patching
- Compensative: secondary layer, provides same or more layers of protections, different technologies (defense in depth)
- Directive: implemented to monitor regulatory compliance, provide guidance.

## Fundamental Security Concepts

CIA Triad: Confidentiality maintains the security and privacy of data, integrity the process of making sure that data and assets are free from unauthorized changes intentional or accidental, availability maintains the access to the systems being reliable and timely.

Chief information Officer CIO: overall responsibility of the IT systems and functions

Chief Technology Officer CTO:

Chief security officer CSO/ Chief information Security Officer CISO: responsibles for information/cyber security

Information Systems Security Officer ISSO: any staff with technical administrative responsibility with security

Non-Repudiation: proof that an individual/system performs an action that cannot be denied. Often implemented with digital signatures and certificates

Gap Analysis: in depth review of all security controls, policies, procedures. To figure room for improvement comparing it to cybersecurity standards and frameworks. Helps with understanding risk and vulnerabilities.

## Authentication, Authorization, Accounting or AAA

Authentication: proof of someone's identity by password, mfa, pin, etc. Method used to verify and prove a claimed identity. Multiple types (factors) of authentication. Something you know, you have, you are, where you are, what you do. MFA combines two or more factors of authentication. Also these methods of authentication need to be protected.

Authorization: verification that the user can access resources but not to resources they shouldn't access. Access control list and authorization models. Occurs every time resource access is in place. Multiple mechanisms/models for authorization.

> Authorization Models:
> 
- DAC Discretionary Access Control: when an owner is assigned to a resource and is responsible to assign permissions. Used by most OS.
- Mac Mandatory access control: use of government for data sensitivity labels assigned to resources and users. Users can access resources that correspond to their clearance level
- RBAC Role-Based Access Control: permissions granted based on job role. Users assigned to roles, roles are assigned to resources.
- ABAC Attribute-based access control: combination of subject/object attributes. OS used, IP Address, patches, location, etc.

Accounting: users are accountable for their actions, logs and audits. Ensure that all access is correct and not abused. Logging, monitoring, and auditing to detect intrusions, monitor suspicious activity, assist with incident response activities.Track actions back to individuals. Legal support. Deter possible malicious actions. Accountability requires periodic reviews.

## Zero Trust

Trust on a network should be continuously evaluated. To protect internet network resources.

Divided into 2 components:

Control Pane: backend communication, policies and administrative

Data Plane: application communication, production section

Deperimeterization ,everything is malicious unless proven otherwise.

Design to reduce the scope of possible threats.

Requires adaptive identity controls and flexible architectures, multiple ways to verify identities.

Control Pane:

Policy decision points: policy engine policies and external inputs, it grants access or denies or revokes. Policy administrator: responsible for establishing communication between subject and resource,

Data Pane:

Policy enforcement point: enable, monitor, terminate connections, communicate with the policy administrator.

Trust Zones: no universal implicit trust in network

## Physical Security

Designed to restrict monitor access to physical locations and assets. Use the same AAA concepts and can be divided into zones. More secure the zone, the stricter controls.

Secure zones should be located far from lower secure zones or public areas. Screens should not face doors, windows, passageways. Use signs and warnings as a deterrent. Entry points should be discrete. Traffic between zones should be minimized.

## Deception and Disruption Techniques

Active Defense: engaging actively with the adversary only in defense. Ex: Decoy assets use for lure or bait without sensitive resources, this should be isolated. These decoys are heavily monitored to get more information on the attackers and also to detect internal vulnerabilities.

- Honeypot: single system specifically to attract attackers. Extensive logging enabled. Early warning of possible attacks. Can drive attention away from sensitive assets.
- Honeynet: entire decoy network, consists of multiple resources (servers, workstations, networks…). Can use actual resources or emulators. Emulators are cheaper but not as convincing. Frequently used for more extensive monitor campaigns.
- Deceptive Files: honeyfiles and honeytokens this is fake data meaningless to the org. Files can contain data that can be used to track. Exe files, Emails, database. This file contains beacons that contact servers once the file is opened. Integrated with honeypots and honeynets.

Disruption Strategies: adopted from obfuscation techniques that attackers commonly use. Make it more difficult and expensive for attackers. Use in production environments and not on honeynets. Ex: fake DNS records. Web servers with decoy directories. Falsified port scans.

## Change Management Operations

Systems and orgs are constantly evolving so a systematic approach to managing all changes in inIT infrastructure, with the goal to minimize disruption and downtime. Documentation is required of what changes have been done. Determine potential impacts and contingency plans.

Changes affect the whole org and can be simple or complex.Structured approval process required to ensure minimal disruptions. New vulnerabilities can be created and unexpected downtime can happen, also compliance issues can appear. After changes are done they should be reviewed and audited.

Stakeholders

Ownership: people that implement the changes, and are accountable for them. They also manage the risk related to the changes. Plan and implement the communications and trainings as needed. Ensure stakeholders are involved.

Change Management Concepts

- Impact Analysis: process of identifying implications of change, how it affects users, process and systems…
- Test Result: changes first tested in test environment before prod, to be able to identify unexpected issues
- Backup plans: reversing changes, returning systems to previous config. Minimize risk of downtime.
- Maintenance window: predetermine window of time for implementing.
- SOPs (standard operating procedures): documented instructions for operations and their changes.

## Change Management Technical Considerations

Allow and Block Lists: this can allow and block what's on the list depending on the contexts. Ex: firewall rules

Change management context: change types not required to go through the entire process. Also others may be not permitted or must go to all the entire process. It will require individuals to approve the changes. .

Allow list and block list should be updated properly

Downtime

Changes often involve restarts, reboots, applications stop running during updates. Should be minimized if possible. Schedule downtime should be announced to the user with adequate notice.

Goal is to reduce the impact to the users and the business processes.

Consider systems with dependencies like servers being updated.

Legacy Applications

Many orgs might still be running legacy software that no longer receive updates, this can contain security issues. Legacy apps might not be compatible with newer software.

Can create complications with other changes. For example a server that is updated might not run legacy software after the update.

May require specialized solutions like virtualization, custom software, extra systems…

Also they may not have sufficient documentation and won't be longer supported by the vendor.

## Documenting Changes

All changes need careful and intentional documentation. Specifying request, notes, approval, discussions, implementations, etc.

Changes often require other documentation to be updated like policies, diagrams, user instructions. Frequency of the documentation depends on the org and the changes made, but usually done when major changes or updates occur.

Updated documentation should be noted with new version information, archive the old documentation with version numbers to see the changes and ensure that the current version is being used.

Types of documentations

- Change Request: information about needed changes, updates to reflect status changes, modifications, approvals, etc.
- Policies and procedures: this need to be updated after the change.
- Systems and processes: updated to reflect the system changes like architecture, diagrams, manuals
- Configuration Management: up to date configuration information, updated after each changes
- Training Material
- Incident Response/recovery plans: see if when changes are done if this docs require any update

Version Control: track all of the changes to documents, code, etc. keep history of all the changes, allow timely reverte changes if needed.

## Encryption

## Encryption Types

cRYPTOGRAPHY Terminology:

- Plaintext: normal text
- Algorithm/Cipher: method of encrypting and decrypting plaintext
- Ciphertext: plaintext that has been encrypted
- Key: data passed through algorithm used to encode and decode
- Keyspace: range of value that can be used to construct a key
- Key Length the number of bits used in the key
- Symmetric Key: use one key to encrypt and decrypt
- Asymmetric keys: use a public and private key separated to encrypt and decrypt.

Encryption and Hashing Purposes

Confidentiality: encrypted text unreadable

Integrity: hash verification ensures data has not been altered

Authenticity: public and private keypairs and certificates verified source of data.

Nonrepudiation: certificates who is doing the activity of encrypting and decrypting

Authorization: certificates used for proving identity and granting access.

Encryption Strength: measure on how difficult it is to break the algorithm, time to break, amount of process power, resource required. This is determined by encryption algorithm, length and complexity of the key, and secrecy of the key.

Symmetric Encryption: uses the same key to encrypt and decrypt.

![](Security+%20Notes/image15.png)

![](Security+%20Notes/image3.png)

Asymmetric Encryption: uses 2 different keys.

![](Security+%20Notes/image10.png)

![](Security+%20Notes/image13.png)

![](Security+%20Notes/image7.png)

## PKI Public Key Infrastructure

Asymmetric keys used to protect keys for symmetric encryption. It is the basis for most encryptions done today.

![](Security+%20Notes/image19.png)

Sharing public keys universally is problematic, how do you rely and trust that they are legitimate?

Public Key Infrastructure systems to make secure communication easy and accessible by having standards, communication protocols, security policies and systems of cryptography.

Its purpose is to establish and maintain a level of trust in keys.

Functions on a hybrid encryption model. PKI is not public key cryptography.

Provides a network of trust. Computers and browsers trust certain Root CAs (these are the top level of certificate authorities). Trusted CAs issue digital certificates which are installed by web servers and others to encrypt communications and verify identity of the servers. Certificates are signed by Trusted CAs, It makes public key verification and identifies certificates.

Root CAs are the primary CA for the orgs, they can verify subordinate CAs, this are heavily secured and are kept offline.

Intermediate CA/ SUBORDINATE CA: trusted and certified by the root CA, they process requests and issues certificates.

Digital Certificates: central concept of PKI. This associates the public key with the owner in a way that can be trusted. Most common standard isX.509.

The subject of the certificate (who owns it).

Issuer is what entity generated and issued the certificate that are the CAs.

- Self Signed Certificates are created by the subject themselves, they can't be trusted as not issued by the CAs, they should be used on internal orgs and only temporarily. Common with default certificates on new appliances.
- Third Party: certificates usually purchased from a specialized vendor. This is trusted publicly.
- Wild Card: these are valid for subdomains on a domain.

Certificate Revocation: this can happen when the private key gets compromised. Two main ways revocation can happen:

- CRL Certificate Revocation List: each CA mainstains a list of all the certificates that has been revoked.
- Online Certificate Status Protocol OCSP: returns single cert status instead of entire CRL.Automatically checks with CAs CRL.

Certificate Signing Request CSR:Used when requesting Certificate from CA. PKCS #10 defines a format for all certificate requests. System/individual requests generate a keypair, keep the private key and the public key is passed to the CA in request. Additional information can be included.

## Encryption Tools

Trusted Platform Module TPM: standard for hardware based storage for encryption data. Normally integrated chip in motherboard or CPU. Each is encoded for a static private key. Subkeys can be reset. It is used to secure storage for encryption keys, and can authenticate hardware platform devices. Useful to verify the integrity of the system.

Hardware Security Module HSM: separate physical hardware device for key management. Usually hardened devices with dedicated security features. It can perform encryption operations like creating digital signatures, authentication… It can be use on PKI environments

Key Management System: system responsible for the complete lifecycle of cryptographic keys. Like generation, distribution, revoking, expiration and renewal of the keys. Commonly integrated in the PKI environments but also standalone.

Secure Enclave: Isolated memory location, allows running code within a trusted execution environment. Ex: Intel SGX, ARM Trustzone.

## Cryptographic Solutions

Data Encryption: data can be in 3 states:

- rest or stored and not being transferred.
- Data in transit or in motion that is being transferred over the network,
- and data in use that is being processed and present on the ram.

File encryption single or multiple files can be encrypted and also folders can too.

Database encryption: entire or partial database is encrypted. It can also encrypt specific tables and columns and records.

Disk level encryption

It can be done on the full drive. For the OS it will decrypt it on the boot process. Keys are normally stored on the TPM.

It can also happen on individual partitions or volumes.

Hashing

One way function that can not be reversed. It can be bruteforce to reproduce the exact input. Algorithms are public information. It is used to verify integrity. Strong hashing algorithms can avoid collisions. Once a hash has a collision it is no longer reliable.

Digital Signatures

Uses asymmetric encryptions. Author creates a hash of the created item then they take the hash and use the private key to sign the hash with their private key. Then the recipient uses the author's public key to decrypt and verify.

Salting

A method used to store password hashes is more secure. Salt is added to the original password before running on the hashing algorithm. Prevents Hash table that is a way to bruteforce it. DIfferent salt for each password even if the password is the same will generate different hashes. Key stretching that is making a password longer with adding the salt and password can convert it into longer keys that might slow down the attacks.

Obfuscation

Steganography embeds information into another source. It can be hidden in an image file/

Data Masking redacting data but substitute characters with different characters.

Tokenization of all data or partially can be replaced with a token. Tokens are stored in a different location that is secure and where the data can be used.

Blockchain

List of records stored using cryptography specifically hashing. Each record is a block run through a hashing function. One block validates the hash of the previous block and so on making it a chain. Recorded on a public leger and decentralized mitigating a risk of a single point of failure.

# Domain 2: Threats, Vulnerabilities & Mitigations

## Attacks

Threat Actors: they can be external with no affiliation with the org and systems or internal that has granted some level of authorization. All attackers have some reason and end goal, and will have some sort of skill.

Nation state actors: these have support from a country. Most developed countries have some sort of cyber attack capabilities. It can be an unofficial support, providing a plausible deniability.

They usually do Advanced Persistent Threat APT.

Organized Crime: Threat actor group that is not tied to a country. More like crime syndicates. May span multiple regions, jurisdictions. Usual motivation is a financial profit.

Hacktivists: motivational is political and social causes. Common goals are to steal data to release it, deface public sites or do DoS attacks. Attribution of these attackers is very difficult.

Unskilled Attacker: people with minimal skill, knowledge and resources. Normally use commonly available tools and malware. Might not understand the tactics they are using and might not have a specific goal.

Internal Threats:

- Intentional Insider Threats: might have malicious intent or acting on opportunity. Intentions might be to sabotage, financial or gain data.
- Unintentional Insider Threats: no malicious intent, commonly exploited by external actors. Most come from a lack of training.
- Shadow IT: people introducing IT or software without IT authorization. Creates unmonitored attack surfaces inside the network

## Attacker Motivation:

Why are they attacking? Curiosity, Financial, Greed, political, etc

- Disruptions: early attacks only to create chaos. Vandalism just for the sake of it is less common.
- Financial: cyber attacks can be very profitable, blackmailing, data can be sold on the dark web, extortions, fraud
- Political: trying to bring some sort of change.

## Attack Surfaces and Vectors

**Attack Surface** is any point where an attacker can exploit a vulnerability. It can be a network, hardware, software. The attack can vary depending on the type of threat actor. Goal in cybersecurity is to always reduce the attack surface as much as possible. Proper monitoring in place for the attack surface that is still available. Some attack surfaces are email systems, public firewall, people, open ports.

Insecure Networks:

- Wireless: improper SSID configuration. Not using enterprise security options and connections where identification is not required. Overpower Radio of the wifi signal.
- Wired: improper port security and monitoring.
- Bluetooth: misconfigured vulnerable devices.

Email: both an attack surface and attack vector. Email systems require connection to an endpoint, this is publicly available and must have open ports for email traffic to flow. It can be used to send malicious files/links and also used for social engineering.

People: hardest attack surface to secure. Technical controls can only go so far with social engineering attacks. Most people are naturally trusting. People must be trained to recognize suspicious attempts.

**Threat Vectors:** a path an attacker is going to take to gain unauthorized access. Attack surfaces and vectors can overlap. Common attack vectors are removable storage, software and hardware vulnerabilities, open ports, images and malicious files, etc.

Removable Storage: USB, HDs memory cards, CDs. Attackers can conceal malware on removable media. This runs automatically when inserted or needs some user action with some kind of social engineering. Some attacks are USB drop attacks. Also it uses some form of lure making the victim curious about the devices.

Malicious Files: one of the most common methods, this can be embedded in legitimate files like apps, macros, steganography. Frequently combine with other vectors like email and removable storage.

Messaging Based Vectors: Email, SMS, instant messaging. Social engineering is the most combined.

Vulnerable and unsupported systems: Attackers frequently look for and exploit vulnerabilities. This can be system information. Procedures, internal control. This is common in all systems like software and hardware. Zero Day is one example of this. Unsupported systems are the ones that don't receive maintenance, or are no longer supported by the vendor.

Network Vectors: Open ports are one of the most used and should be restricted to only necessary ports. Any open port can be used as an attack vector.

- Wired networks have their own set of attract vectors like unprotected physical network ports. This can allow things like eavesdropping, DoS attacks,etc.
- Wireless networks can have compromised credential and spoofed AP names for credential harvesting.
- Bluetooth connections: misconfigured and older versions.
- Default credentials like any device still using default credentials. This is probably published on the vendor's documentation.

Supply Chain: the process of designing, manufacturing and distributing product or services. If an attacker compromises one entity in the chain the rest of the downstream can be compromised. Managed Service Provider MSPs are usually affected by this process. Suppliers and vendors can be compromised too.

## Social Engineering

It is like hacking a human, making some to perform an action that makes it able to progress the attack. It may include a sense of urgency and involves abusing some sort of trust authority.

Impersonation: pretending to be someone else. It can use 2 tactics: persuasion or coercion. Pretexting is used to create an elaborate story.

Phishing: spoofed email addresses. Also from compromised addresses. Different levels of target audience get different names for phishing names.

Vishing and Smishing: phishing using voice and sms messages respectively. Based on AI these attacks will increase.

Typosquatting: similar written addresses usually domains. Taking advantage of user error.

Watering Hole: relies on a group of targets using the same third party site. Attacks must first compromise the site to deliver malware.

## Vulnerabilities and Attacks

## Vulnerabilities

Zero day vulnerabilities: brand new vulnerability that still has no patch or fix available. AV might not be able to detect the exploit. These are extremely valuable to attackers. Usually used on mid and high level attacks.

Misconfigurations: this comes from misconfigured systems. Like default settings and passwords. Also using insecure administrative accounts with default passwords and not MFA. Improper permissions and excessive open ports. Unsecure protocol usage. Also temporarily disabling security settings for troubleshooting.

Supply Chain vulnerabilities: relying on other companies as vendors and suppliers can create a compromise chain if one of those presents a vulnerability. Mitigation for this is careful vendor selection and assessments. Vulnerabilities can be introduce through service providers, hardware suppliers, software providers

Mobile vulnerabilities: sideloading (android) installing apps from anywhere that is not on the official app store. Jailbreak (apple) removes the built in limitation to gain full access to the device. To mitigate this you can use a mobile device management (MDM) to monitor and control devices that have access to org resources.

Cryptographic Vulnerabilities: any sort of weakness on the algorithms and protocols used. Ex: using MD5 and SHA1 that can cause collisions. Usage of weak keys. How are the Keys going to be secure?

## Application and Web Vulnerabilities

Application Vulnerabilities

- Memory Injection: security flaw, attacker can inject malicious code into app process memory. Specifically designed code to provide unauthorized access. Code injected has the same privilege level as application. Can cause a full system compromise.
- Buffer Overflow: type of memory injection. A buffer is an área of memory reserved by an application to store expected data. Attackers will pass more data to the reserve space than what was expected, making it overflow. It can make the app malfunction and then run arbitrary code.
- Race condition: software logic may fail to check or enforce a different order. Making the app crash or data corruption. Ex: time of check to time of use TOCTOU. This can be solved by the developers mostly.
- Operating System vulnerabilities: System level or kernel level exploitation. Identify through bulleting from the vendor, vulnerabilities scans, threat intelligence.
- SQL Injection: web servers send queries to DB server and return responses, SLQi attack modifies a query by adding specific code to input on webpage, allowing the code from the attacker as a query. It can allow an attacker to extract sensitive information from DB. Best defense is to ensure input sanitization.
- Cross-site Scripting XSS: scripts are on most modern websites. XSS attacks are to insert malicious scripts that look like part of the website. There are different types like:
    - Nonpersistent/Reflected: attacker creates link to perform injection against trusted site
    - Persistent/Store: inserts code into backend site.
    - DOM Based (Document Object Model): it modifies the behavior of users' browsers.

Cloud Specific

Cloud services operate on a shared responsibility model.

- Cloud Access Security Broker CASB: provides visibility to how users/devices use the service. This can monitor, scan, and prevent exfiltration.
    - Forward proxy use by configuration of the devices that are installed on the perimeter and can communicate with the cloud provider.
    - Reverse Proxy: this is installed on the cloud.
    - API application programming interface: provides extra functionality and integration, like provisioning and disable accounts.

## Hardware and Virtualization Vulnerabilities

Hardware

- Firmware of the hardware. This is what controls the hardware like BIOS and UEFI. It indicates to the hardware what to do. More difficult to manage, patch or mitigate.
- End of life cycle EOL: any system, app that is no longer supported by the vendor/developer. Also applicable to apps approaching EOL. All products will eventually reach EOL. This won't usually receive more security updates. Extended support may be available.
- Legacy devices are outdated technology.

Virtualization Vulnerabilities

- VM Escape: Malware running on a guest machine can escape to another guest or to the host. Attackers first must identify the machine they are on is virtualized. It can also attack other VMs on the same host. Also can let attackers access the network. Recommendations: do not host sensitive servers on the same hardware as lower security.
- VM Resource Reuse: virtual machines commonly use shared resources like disk, memory, etc. When deleted and migrated resources might not be properly sanitized. This can vary on the infrastructure used. Can result in sensitive data being leaked. Making the data from the Old VM being accessed by the new VM.

## Malware Attacks

Software that does something bad for the user. Malicious software.

- Virus: malware with the capability to copy itself and spread. Often happens without the knowledge of the user.
    - Non Resident files are virus-contained and run in Exe process.
    - Memory residents are viruses that run from the original executable and remain in memory after the process ends.
    - Boot is code written to the boot sector of the disk, that is executed when the OS starts.
    - Script base and macros are added from another file like word, pdf, powershell, etc.
- Worms: memory resident malware, they don't write themselves to the disk, make use of legitimate tools to “live off the land”. Runs without user intervention. They can replicate across various mediums. Also used for DoS attacks and other disruptions.
- Trojans
- Ransomware: Malware that attempts to extort victims for money to recover data. Will prominently display notice demanding payment or other actions. It is not recommended to pay the ransomware as almost never will get your data back. Sometimes it is illegal to pay for the ransom.
- Potentially unwanted programs PUPs: not all are malicious or cause harm but they are considered malware. Tracking cookies.
- Adware:form of bloatware installed on systems
- Spyware: design to collect data and monitor system usage. Can also contain Keyloggers.
- Remote Access Trojan (RAT): program that hides execution of other processes, usually malicious. RAT provides a backdoor access to the system. May be used to install bots.Command and control is also used with attacker controlled infrastructures that compromise the systems.
- Rootkits: this can run unrestricted with system level permissions. Very difficult to detect and remove. Can compromise critical systems files. High level of access results in effective masking. They can erase logs to hide evidence of infections. Modern OS have mechanisms to prevent rootkits
- Logic Bombs: this is typically going to be an inside threat Malware that won't run immediately, can wait for predetermined date/time or specific events before executing.

## Physical and Network Attacks

Physical Attacks

- Attacks on the infrastructure: like facilities, hardware, cabling,etc.
- Brute Force Attack: physically break something like locks, data cabinets, office buildings.
- Environmental: like cutting cables, disrupting cooling systems.
- RFID Cloning: making copies of existing RFID, by skimming.

Network Attacks:

- DDoS: attacks designed to disrupt systems that come from multiple locations, systems.
    - Amplified: request portion of attack small to request large amount of data.
    - Reflected: attacker spoofs targets IP address, sends request to third party site with fake reply IP.
    - Combination of Amplified and reflected
- DNS Attacks:
    - On path: ARP poisoning to respond to DNS queries with spoofed replies.
    - Client Cache poisoning: modify local host file to redirect domains to attacker controlled IP.
    - DNS Server cache poisoning
- Wireless Attacks:
    - Rogue Access Point: access point installed on the network without authorization. Might not be malicious intent. Evil twin is a rogue AP masquerading as a legitimate AP.
    - Dissociation Attack: forcing victims devices to disconnect from a Wireless Network. This is used to try to capture network keys.
    - Jamming: rogue AP with more powerful radio.
- On Path Attacks:
    - Attacker gains position between two devices on the network. Man in the middle.
- Credential Replay: mostly target windows AD networks. LSASS Local Security Authority Subsystem Service, this can cache passwords and secrets. Attackers can gather the secrets to perform various attacks. Windows credential guards help protect against this attacks.

## Application Based Attacks

Privilege Escalation: attackers goals are to gain as much access as possible to a system. When first compromising a system the permissions they have may vary depending on the application they are exploiting. The goal is to get as much access as possible.

- They can use vertical privilege escalation, a user or app can access data that shouldn't.
- Horizontal Privilege escalation: accessing functionality or data that is intended for another user.

Buffer Overflow: attacker submit data into a field too large to be stored in designated space. Stack overflow is one of the most common. It can allow attackers to run arbitrary code.

Replay Attacks: common use on web applications. Usually used to compromise tokens and cookies. Cookies can be nonpersistent (aren't stored), persistent (are stored).

Forgery: hijacking an authenticated session without user consent. Attackers send the http legitimate request to the victim, and spoof the legitimate action on the target site.

Injection Attacks: this exploits how the applications process requests and queries.

Persistent XSS and SQLi, XML injection, LDAP injection

Directory Transversal: type of injection attack against a web server. Allows attackers to gain access to files outside of the web server directory.

## Cryptographic and Password Attacks

Cryptographic

- Downgrade Attack: the attacker requests from the server a lower protocol as it generates weaker ciphers and smaller keys. This is used often for man in the middle attacks.
- Collisions: when two different inputs result in the same hash. This can be used to forge digital signatures.
- Birthday attack: how large a group of people should be so that they can share the same birthday. Attack process of creating two files with minor changes.

Password Attack Online is when the attacker interacts with the service directly.

Password Attack Offline attacker does not directly interact with the resource. It can use brute force methods to attempt to crack passwords. Only indicator is the access log.

- Password Spraying (online): attacker takes a password and uses those on multiple attacks.
- Brute force (online and offline) password attempts using every possible combination. It will depend on org requirements for its effectiveness. Can take an extended amount of time to crack passwords.
- Dictionary attack: use of a common list of passwords to guess the passwords.

## Indicators of compromise

These are ways to know if someone has malware.

TTPs Tactics,Techniques, Procedures.

- Tactic is a description at a high level of what an attacker is doing.
- Techniques: more detailed descriptions like reconnaissance on how they are performing the tactic.
- Procedures: what is the attacker exactly using. Very detailed.

IoC Indicators of Compromise: logs, signs or information that something is being attacked or has already been attacked. Many different types of IoCs and new ones are constantly being discovered. Ex: connection logs to C2 servers. Disable backups, logs deleted or modified.

Malware Indicators: this needs correlation with other indicators to not have a false positive.

- AV/ EDR alerts.
- Excessive resource usage.
- Resources that are inaccessible.
- File systems indicators.
- Account compromise indicators (lockouts, concurrent session usage, impossible travel)
- Logging: Missing or altered logs, spoofed logs, logs removed, out of cycle logging
- Sandbox detonation/execution

Specific Indicators

- DNS: event logs on DNS server. Type of queries individuals perform. Anomalies in traffic.
- Malicious code: presence of shellcode. Credential dumping. Persistence in the form of autorun.

URL Analysis: Can assist in identifying session hijacking and replay forgery injection. Actions can be encoded into URL like : GET, POST, PUT. URLs can only contain certain characters.

## Mitigations and Hardening

## Mitigation Techniques

Least Privilege: only grants minimum permission needed to a user, device, system, to complete its job. Requires regular auditing roles. It requires understanding what those jobs require to complete their job. These are constantly being updated and adjusted.Role based access controls are required and then users are assigned to that RBAC.

Network Segmentation: practice of physically or logically separating parts of the network, to reduce attack surface and limit the spread. Goal is to make it more complicated to the attacker, making it easier to provide granular control to data access. This can be done with physical networks or VLANs.

Monitoring: help enforce and maintain security controls. Detect changes that may weaken the hardened config. Data for compliance and auditing.

ACL Access control Lists:rules that specify if actions and traffic should be allowed or denied. Network (like firewalls) and file system. Each entry contains subject and object, associated permissions and other qualifiers. Each file system object will have an ACL.

Decommissioning: taking a device from a network. Often this can contain sensitive data, documented processes when systems retire. Securely erase all sensitive data. Reset devices to factory defaults. Update inventory systems.

## Endpoint Mitigation and Protection

Application

- Allow List: list on an endpoint for specific software where if the application is not on the allow list it won't be able to run. It can result in apps not running properly, mainly after updates.
- Block List: contrary to the allow list and easier to manage, but higher risk.

Configuration Enforcement: methods to ensure devices adhere to security configurations. Standardized baselines. Needs continuous monitoring and compliance check to detect deviations.

Patching: every system, device, application will require updates at some point. Auto update can introduce performance issues so larger orgs might use a patch manager system. Good idea still to test patches and updates in isolated environments. Downtime scheduling is often required.

Encryptions: full disk encryption. Usually performed by OS.

Self encrypting drive:this is handled by the drive instead of the OS.

## System Hardening Techniques

Endpoint protection clients:

- Antivirus: mostly signature base to identify malware. Usually won't identify new attacks.
- Endpoint Detection and Response EDR: greater protection and features than AV.
- Data Loss Prevention DLP: help prevent unauthorized removal of sensitive data from Orgs. Enforcing policies to prevent copying, emailing, printing.
- Planning and best practice: deployment plan with standardized configurations, automate updates, patches. Monitor to see if there are any alerts.

Encryptions:

- Full disk encryption FDE
- Removable Storage
- VPN: provides secure communication route
- Email Encryption: PGP, S/MIME Secure Multipurpose Internet Mail Extension

Host Based Protections:

- Host Based Intrusion Detection Prevention Systems: analyzes local device potential malicious activity.
- Host Based Firewall: similar to network firewall but on local hosts.
- Logs integrated with SIEM systems.

Defaults:

- Change default passwords
- Change default usernames if possible
- Disable all default network ports unless needed.

Physical Port Protection:

- Minimize Physical interfaces available
- Multiple Methods available:
    - Completely disable ports as needed
    - Use software to allow only authorized devices
- Devices available to attackers:
    - USB drives that auto install malware
    - Hardware keyloggers or keystrokes.
- Can help reduce data theft too.

Unnecessary Software and Services

- Uninstall any included software that is not required.
- Disable and or uninstall any services that are not required: be cautious on services that can be system critical.

# Domain 3: Security Architecture

## Architecture and Infrastructure

## Network Infrastructure

Infrastructure:

Network consists of nodes and links

- Links are how the devices are connected. These are in Layer 1 of the OSI model, fiber optics, wireless, etc.
- Nodes: host normally servers or clients. Intermediaries host, like switches and routers.
- On premise network: installed at a single site location.

Switches: layer 2, this forward frames/packets, most non wireless devices connect vía cable to switch. All devices have a hardware address or MAC Address. Wireless access points also are at layer 2.

Routers are at layer 3, forwarding traffic between network segments based on IP address. Each network segment has a router as a default gateway.

Layer 4 is the protocol for transport like TCP and UDP.

Layer 7 has application protocols.

Segmentation:

Restricting communication between hosts on different network segments.

Physical segmentation has unique network equipment for various subnets/broadcast domains.

Logical Segmentation: physically connected to various networks, divided by VLANs.

Software Define Networking

Helps facilitate IaC Infrastructure as Code. Physical and virtual network devices configure with scripting and APIs. SDN is used to define policies for the network.

This has network function planes. Like

- control plane that makes decisions about traffic prioritization, security and switching.
- Data Plane: performs switching and routing activities and imposes security controls
- Management Plane: monitors traffic and network status.

## Cloud Infrastructure

Cloud Deployment Models: describe how the services are going to be used and who owns it.

- Public: services offered by cloud services providers. Subscription and Pay as you go.
- Private: infrastructure completely private and owned by organization. Also on premise infrastructure.
- Hybrid uses both on premise and cloud systems.

Deployment Security Consideration

- Multi Tenant: multiple customers share the same infrastructure. More cost effective but higher risk.
- Single Tenant: dedicated infrastructure. More expensive but also more secure.
- Hybrid: combination of the two, security and flexibility.
- Serverless: cloud provider manages infrastructure and scaling.

Cloud Service Models

IaaS

PaaS

SaaS

Responsibilities: security risks are shared when using cloud services. Responsibility will vary depending on the service model.

## Cloud Architecture

Serverless Computing: cloud provider manages all the infrastructure. Can allocate resources, handle redundancy, load balancing, provisioning. Only charge for the resources actually used. Reduce the need of managing servers. All architecture is cloud hosted.

Microservices: application development through smaller independent services. Designed to be modular. Often uses Infrastructure as Code IaC. Files use formatted code to manage and provision with YAML and JSON code. Config Settings, network options, security, etc.

Centralized vs Decentralized Computing

- Centralized: data processing and storage occur in a single location. Users and systems rely on central servers and systems. Common to see in an enterprise network. AD, Files, Applications Servers are all centralized.
- Decentralized: everything is spread across multiple systems and locations. No single point of failure.

## Virtualization

Multiple systems running at the same time on a single host computer

Uses a hypervisor. That is a software that manages and runs virtual machines.

- Type 1 installed directly onto hardware as an OS. Also known as bare metal. Ex: VMware ESXi
- Type 2 installed on top of an already existing OS. Ex VMware Workstation

VDI Virtual Desktop Interface: uses virtualization to deploy workstations.Runs on thin client machines.

Application Virtualization: Type of VDI. More limited and use for remote access. Only runs individual applications and not the whole desktop. Applications are hosted on server and most used with HTML5, can be accessed with standard web browsers.

Containerization: form of application level virtualization. Does Not use a standard hypervisor. Each instance is assigned to an isolated cell or container. Allocated system resources and run through native OS Kernel. Allow for running various applications version in isolated environments. Docker is one of the more populars.

Virtual Machines vs Containers.

![](Security+%20Notes/image18.png)

Virtualization Risks

VM Escape: malware running on guest OS pivoting to another guest or host OS.

Requires to identify the system is virtualized and can result in a rapid malware spread.

Virtual Host/guest management

![](Security+%20Notes/image14.png)

## IoT and ICS

Embedded systems: computer systems design to perform specific functions.

- IoT Internet of Things: appliance with many uses, with some sort of network connectivity. Security controls are difficult to implement. Best form of defense is isolation. Often attacked and used in botnets.
- ICS: Industrial Control systems: designed to control hardware. Ex: Operate valves, run motors, etc. Used for critical infrastructure. Should always be on isolated network
- SCADA: supervisory control and data acquisition: systems that run as servers and interact with ICS. Typically run on standard PCs. Gather data and provide instructions. Use in multiple industries. One vulnerability is Stuxnet that is a worm that attack SCADA on window.s
- RTOS: Real time operating system: dedicated OS use for specific purposes. Low tolerance for crashes or reboots. Small attack surface, but still have vulnerabilities.
- OT: Operation Technology

## Architecture Considerations

Sizing and cost:

Cost can come into play in purchase software, licensing, maintenance, support.

Value also calculated from incident loss reduction. Also value can be calculated from incident loss reduction. Processing power and responsiveness. Power requirements.

Performance and Reliability: availability maximizing uptime and minimize downtime. Scalability, with how easy it is to add or remove resources.

## Infrastructure Considerations

Device Placement: what devices are important in what location.

Defense in depth

Network perimeters: separation between the public and enterprise internet, and between internal segments.

Inside Networks: traffic monitoring. Detection of malicious activity that evaded perimeter controls.

Endpoints and combination of preventive, detective and corrective controls

Security Zones: area of network containing host with similar security requirements. This requires inventory and risk analysis. Network segments based on functions and access control requirements. Zones should have known entry and exit zones like a specific router interface. Should also be based on least privilege policies.

Attack surface: any point where an attacker can exploit a vulnerability. Varies depending on attacker type. Evaluation depends on scope: Layer 1/2 physical ports, Layer 3 IP addressing and routing, Layer 4/7 port and app protection. Entire infrastructure is attack surface

Failure Mode Options: what a device or system is going to do when it fails.

- Fail open is when operation continues as if the device was not even there, this is used when the continuation is more critical than security.
- Fail closed: when failure conditions present, when security is more critical than functionality.

Choices depend on the company risk appetite.

Device type:

- Active security control often uses agents installed on the endpoint for scanning/filtering. Requires credential access permissions for client host data exchange
- Passive security control: does not require any agent or client host data transfer. Collection of network traffic from switch
- Incline: device inserted into communication path. Copies signal from cable to monitor device with a TAP device.
- Monitor: SPAN/mirror specific port configure to copy traffic to sensor.

## Network Security

Intrusion Detection and Prevention:Network sensors used to capture traffic. Place near by the device most interesting to monitor.

Intrusion Detection System IDS: software of appliance that performs real time analysis of network traffic. Does not take any action, only detects.

Intrusion Prevention Systems IPS: similar to IDS but with additional capabilities like besides alerting provides active response. Can block traffic and reset connections or redirect to honeypots.

Firewall:

- Stateless doesn't use much longer, it just checks individual packets to see the state of the connection and then takes action based on the rules of the firewall. But it doesn't track connection history.
- Stateful: does track connection history, keeps track of the connections and their state.
- Web Application Firewalls WAF: design to protect web servers and backend components. They have application aware filtering. Can use signature based or pattern based detection. Layer 4 checks for a 3 way handshake. Layer 7 checks various application protocols.
- Next Generation Firewalls NGFW: upgrade from early packet filtering firewalls. Introduce additional features like connection aware and user based filtering. Includes some sort of IPS functionality.
- Unified threat management UTM: all in one system. Firewall, IPS, AV, Spam filtering, VPN. Must be properly sized/configured to avoid latency. Also potential single point of failure.

Network Appliances

Jump Server (box): dedicated administrative workstation. Locked down hardened to only allow specific traffic use. Usually only allow traffic on dedicated management ports. Use to manage secure zones.

Load Balancer: distribute traffic across multiple destinations. Operate at Layer 4 or 7. Used for fault tolerance and redundancy to ensure availability. Can also be used for DDoS mitigation.

Proxy Servers:

Work on store and forward packets. Can be configure to also allow and deny

Forward Proxy: typically used with web traffic, analyze, filter, modify traffic. It checks outbound connections from the client.

- Transparent: router configuration or incline appliance
- Non Transparent: client configuration to send traffic through proxy

Reverse Proxy: inbound traffic, typically in front of public servers.

Port Security:

Disable unused ports.

MAC Filtering: allow list of MAC addresses permitted. Another option is to only permite specific number of MAC addresses per port.

802.1X Authentication; uses AAA architecture.

- Supplicant device attempting to connect to the network.
- Authenticator device attempting to connect to like a switch
- Authentication Server
- Two protocols used for authentication:
    - EAP Extensible Authentication Protocol: frequency used with digital certificates to establish trust.
    - Remote Authentication Dial in User Service RADIUS.
- When connecting, the switch allows only EAP protocol traffic.
    - Receives supplicant credentials vía EAP
    - Uses RADIUS to send to the authentication server.

## Secure Communications:

Remote Access: connecting to a network through an intermediate network. VPN technologies like TLS/IPSec, Remote Desktop, Secure Shell (SSH).

SEcurity recommendations for remote access: secure and encrypted connection. Least Privilege. MFA.

Remote Desktop: user GUI tools to connect to individual or virtual desktops. Ex: Microsoft Remote desktop protocol. If used remotely, never to be used on Port 3389. HTML5 supports remote desktop in browser.

VPN:

- Client to site VPN: software installed on client computers connect to VPN gateway.
- Site to site VPN: two VPN gateways establishing trust and secure connection. No endpoint/client configuration require
- Establish a secure tunnel to keep communication private.
    - PPTP should noy be used
    - TLS transport layer security: client connection to remote access server, uses digital certificates.encrypted tunnel to then submit authentication credentials. Use a modern version of TLS.
    - IPSec: two core protocols. A
        - Authentication Header AH. Performs hash on the entire packet with a pre-shared key. No encryption, no confidentiality provided.
        - Encapsulation Security Payload: encrypts packet. Attaches 3 fields to packet header, trailer and ICV.
        - Two modes: transport mode secure communication between hosts on private networks and tunnel mode which do communications across unsecure networks.
- Other Secure Access
    - Software defined wide área network SD Wan: routing and tunnels managed by software and automation. It is used to connect offices, data centers over the WAN. Encrypting tunnels for secure communication.
    - Secure Access Service Edge SASE: Combines WAN and cloud Security. Provides secure access to cloud application/services, useful for securely accessing cloud services regardless of location.

## Data Types

Regulated Data: any data subject to laws and legal regulation based on the región they are in.

- PII: personal identifiable information: SSN, DLM, name/address, credit cards data.
- PHI: protected health information. The USA is regulated by HIPAA.

Intellectual Property: proprietary information, anything created by an org. Frequently targeted by competitors and nation-state actors. Copyright and trademarks. Trade secrets are specific types of intellectual property.

Financial Information: belong to customer or client information. Bank and investment information, accountings, credit cards. Organization financial data.

Data Readability:

- Human readable data: any text a human can easily interpret
- Non human readable: information not easily understood by people like binary, machine, encrypted data.

Each requires different forms of security controls.

## Data Classification

Different types of data need different types of protection. Based on the degree of confidentiality required. More protection increases complexity in its access.

Manual Classification: user apply labels to data created

Automatic Classification: systems apply based on contents /location/ metadata.

Classification based on confidentiality:

- Public data: no restrictions on viewing. Would pose no risk to org if released. Potential risk if modified without authorization or not available.
- Confidential (secret): sensitive data restricted only by approved individuals and some third parties
- Critical (top secret): can't be disclosed under any circumstances and has significant restrictions. Very high risk.

Classification Based on Information Type:

- Proprietary data: Intellectual property.
- Private data: personal data. Usually related to individuals.
- Sensitive data: can be personal data but also information of orgs. Information that can harm an individual, GDPR.
- Restricted: confidential data with limited access.

## Securing Data

Data Sovereignty: Jurisdiction that prevents data process and store in certain locations. May require that data physically reside within jurisdiction. Ex: GPPR: any EU citizen data regardless of org location.

Geolocation: storage locations for data may be subject to specific regulations and laws. May impact incident response activities based on regulations.

Cloud providers often allow choice of where data is stored. Employees may need access from multiple locations.

Data States:

- Data at rest: data stored on persistent storage. Ex: Files on servers includes backups and archives.
- Data in transit: process of being transferred over network. Ex: Website traffic
- Data in use: data present on RAM, CPUs. while data is decrypted for use it is data at used.

Securing Data:

- Encryption: encrypted data cannot be read without decryption.
- Hashing: data integrity validation.
- Masking: redacting all or some of information. Ex: replacing some characters with other characters.
- Tokenization: when replacing portions of data with randomly generated tokens. Token stored on a different server from the original.
- Permission restriction: setting access controls on files. RBAC. ACLs in OS.
- Segmentation: network and system segmentation. Helps limit of breach and intrusion
- Obfuscation: making the data more difficult to interpret
- Geographic restrictions: limiting access to data based on physical location

## Resilient Architecture

High Availability: maintaining the uptime of the systems. Measure by percentage of systems are available. Measure in the cloud by uptimes. Avg of downtime per year.

- Load Balancing: one of the ways systems can be highly available: spreading workload between multiple resources. Networks, servers, applications, etc.
- Clustering: multiple servers sharing the same data and session info. Allows seamless failover. It uses a virtual IP address that is a single IP address that is shared among the cluster members. But still each device still has its own IP.
    - Active/Passive cluster: one node in cluster is active processing while the other is in standby. No performance effects during failover, but resources get unused.
    - Active/Active: both nodes process at the same time. Max processing capacity, but performance degrades during failover.

Site Resiliency: can be accomplished using multiple sites. Resilience and high availability can be accomplished using multiple sites. Geographic location of sites is important.

Site Classification:

- Hot Site: near instant failover. High cost, minimal downtime.
- Warm Site: systems online, or ready to be used. May need data to be updated.
- Cold Site: systems may not be present, only location available. Lowest cost, longest downtime.

Diversity

Defense in depth: no single control can protect 100%, multiple layers of security using various products.

Platform and vendor diversity: risk reduction. Different systems will have various vulnerabilities.

Cloud diversity is the same as platform and vendor diversity.

Power

Multiple methods to implement redundant power. Depends on needs and budget.

Dual Power Supplies: most enterprise equipment includes 2 power supplies. Connect to different circuits.

Uninterruptible power supply UPS: battery backup that equipment connects to.

Generators: various types of fuels.

## Business Continuity

Continuity of Operations: org can maintain or quickly resume operations after a downtime.

Focuses on critical functions during an emergency. Generate a business continuity plan.

Capacity Planning: determine required resources to meet objectives. Forecasting to anticipate future growth and change.

- People: number of employees, skill sets, training.
- Technology: hardware, software, network resources.reliability, scalability, supporting the org needs.
- Infrastructure: physical facility requirements.

Addressing Planing Risks: cross train employees in other job roles. For redundancy. Ensure adequate planning for remote work. Establish alternate reporting structures. Risk from workforce reduction.

Resiliency Testing:

- tabletop exercises, simulated incidents like attack from ransomware or physical disaster.
- Failover test: make systems intentionally fail in a controlled manner.
- Simulations: similar to tabletop but replication of the scenarios.
- Parallel Processing: run primary and secondary systems simultaneously to see if they are up to date and running seemingly.

## Backups

Data is important to any organization. Data can be corrupted or lost. Policies and procedures for backups should be created. Backup should have considerations like frequency, retention, destination, etc.

Frequency of Backups: typical backup frequencies annual, monthly,etc. Frequency will be determined by the need of the org and regulations. How volatile is the data? What is the infrastructure capability?

- Stable data usage: less frequent.
- Dynamic data usage: more frequent and stricter regulations

Backup storage:

- On Site: stored locally in the same location as prod systems, great for rapid recovery. Risk against physical disasters.
- Offsite: remote location, better physical security.
- Replication to other locations (redundancy)

Advance Backup Strategies

- Snapshots: captures state of systems/data at a specific time
- Replication: exact copies of data on different systems and locations. Can provide granular rapid recovery.
- Journaling: record changes to data in a separate log. Track changes over time.

Backup recovery

- Validation and testing of the recovery process.
- Full recovery test: restore entire system
- Partial Recovery test
- Simulat disaster scenarios to gain insights.

# Domain 4: Security Operations 1

## Securing Systems

Secure Baseline: standard set of config and settings for specific devices so they are the same and no disparity between the devices. Set consistent rules for config and security. CIS Benchmarks publish best practice guides and are available for various compliance programs, also they have product benchmarks.

What is Security Hardening? All devices have default settings that are not necessary for security so system hardening is to reduce the vulnerability from the default settings. Improving its security. Ex: Remove extra functions that are not needed. Don't make a device so secure that is hard to use.

Standard Hardening Recommendations

Use baseline configurations and checklists. Change all default passwords. Close unused and unnecessary network ports. Stop services that are not needed. Perform audits to ensure controls are still adequate.

Switches and Routers

Disable unused services and interfaces like HTTP. Use secure management protocols like SSH, HTTPs. Restrict access to devices. Logging and monitoring Port Security and checking that the devices are in a secure location.

Servers: Ensure security patches and updates applied regularly. Configure firewall and IPS systems network and also host based. Use strong passwords and MFA. Logging and monitoring, installed AV and EDR, also physically secure the devices.

Workstations and endpoints: disk encryption for workstations.Protect sensitive data and cached credentials. Limit administrative access for standard users. Restrict applications that can be installed. Prevent users from changing critical configuration settings.

## Embedded Systems Hardening

Selection of control is based on the OS that will run on the devices. Based on guidelines, best practices and benchmarks will be taken into account. Standard Hardening:

- Regular Updates
- Disable services
- Change default credentials
- Limit access on the network: like segmentation, firewalls and IPS, secure management protocols.
- Regular audits.

ICS and SCADA systems: information divided in IT and OT Information Tech and Operational Tech. IT manages data and OT controls the physical world. Systems often interface with critical infrastructure. Control network separated from the rest of the enterprise network. Careful testing of all updates. Heavy restrictions for removable devices. Unidirectional gateway (data diode)

Internet of things IoT devices: use the same guidelines as other devices and do network segmentation. Disallow them from the enterprise network.

## Wireless Security

Installations and considerations: where to put the access point (AP). Each wireless network is identified by a SSID. Placement is important, avoid interference between AP operating on the same channel. Site survey collecting data about location to properly build wireless infrastructure, it helps identify weak and strong point (heat map), usually start with the floor plan

- Cryptographic protocols: Older standards used wired equivalent privacy and should not be use (WEP).
- WPA: Wifi Protected Access, is the current standard.
    - WPA1 better than wep but also no longer secure enough
    - WPA2 uses the AES advanced encryption standard.
- WPS: Wifi Protected Setup, used with WPA2, button on AP and PIN. generates random SSID and PSK for connection, vulnerable to brute forces
- WPA3: uses SAE simultaneous authentication of Equals. Replace WPA-PSK, WiFi password cannot be intercepted from captured data. Enhanced open as all traffic is encrypted even when not using a password. WiFi easy, connects by connecting with a QR code.

Authentication Protocols

- WPA2 PSK authentication : passphrase that generates key to encrypt communications, all clients use the same key to connect.
- WPA3: still uses passphrase but different means of generating session keys.
- Enterprise Authentication: Used for WPA2 and WPA2 enterprise configuration. Can use the 802.1x authentication. Every uses has a different set of credentials to connect.

Radius Authentication Process use on the 802.1x process

AP configured with RADIUS server IP and shared secret.

![](Security+%20Notes/image4.png)

## Mobile Security

Deployment Models:

BYOD bring your own device. Device is owned by an employee. If it is going to be connected to the org it needs some sort of controls to protect the org network. Ex: corporate app stores. This is the highest risk by the org.

Corporate Owned devices:

- COBO corporate owned business only
- COPE corporate owned personally enable: allow for personal usage as well
- CYOD is similar to COPE but the user can choose devices from the available list.

Mobile Device Management MDM

Central Management of Mobile devices, set and enforce policies for security, apps, mobile features, etc. Ex: authentication requirements. Mandatory applications on the devices and allow application list. Pre-configure email account configurations. Often allow for remote full/selective wiping of devices.

Connection Methods

Cellular connection not controlled by organizations. Policies to restrict data transmitted over cellular

WiFi: strong enterprise networks can reduce risk of eavesdropping. Ad Hoc devices connect to each other. WiFi direct one to one connections uses WPS. Tethering sharing cellular connection over wireless.

Short Range Connectivity

Bluetooth: several security risks. Device discovery. Authentication is usually a simple PIN. Malware and vulnerabilities, bluejacking unsolicited messages over bluetooth.

NFC near field communication. Like contactless payments. No encryption in communication.

Location Services: uses network services to determine physical location of the device

- GPS: uses satellites to determine latitude and longitude.
- IPS: indoor positioning system

Geofencing: virtual boundary created based on physical location.

Privacy concern with locations.

## Application Security

During development and after development.

Secure Coding:

Input Validation: any point where users can input fields can be used for injection attacks.

Client Side: checked before sent to server

Server side: checked by server but after acceptance and processing.

Types: allowlist, blocklist, data type, range, regex, encoding, etc.

Secure cookies: all cookies should have an expiration date. Attributes can be set to implement, like secure attributes that are only sent over HTTPs. HTTPonly prevents client side scripts from accessing. SameSite limit where/when cookies are sent.

Static code analysis: examine the source code to see potential vulnerabilities and errors.

Code Signing: use digital signature to verify integrity and authenticity. Same digital signature process by hash. Malware still can be signed.

Sandboxing: running software in an isolated environment. Running processes can be isolated from each other. Multiple testing and debugging.

Other Application Protections: proper error handling. Secure data handling to prevent unnecessary exposure. Monitoring log errors and exceptions.

## Asset Management

Asset Procurement: requires policies and processes in place to properly manage. Applies to product and services purchases. Authorized vendor/suppliers list. Prioritize purchase that integrate well with existing infrastructure

TCO Total cost of ownership: how much will this product cost over its entire lifetime.

Assignment and Classification

Assignment: asset owners person responsible for the asset. Establish accountability for equipment/software.

Classification: organizing by value, purpose, criticality.

Require periodic reviews and audits.

Monitoring and tracking

Inventory as the primary method of tracking.

Track location, owner, status, patch level, etc..

Multiple methods of enumerating devices: Manual process, Network scanning, asset management software, configuration management database, MDM solutions, cloud asset discovery.

Asset Decommissioning

- Secure methods to dispose/retire while meeting compliance requirements
- Normally focus on data.
- Sanitation: removing sensitive information, specialized techniques. Data should be completely unrecoverable
- Destruction
- Certification: third party vendor verification data sanitization.

## Identifying Vulnerabilities

Vulnerability Scans: System designed to test hosts (networks, servers,etc). Uses vulnerability database to identify potential vulnerabilities from scan and ties it. Require good inventory of systems on the network.

Process:

- Scan run against identified targets
- Report compiled from scanner.

Types of vulnerability scans

- Non credential scan: does not require username/password on device. Will not be able to detect all vulnerabilities on the host.
- Credential Scan (authenticated): requires an account configured on the host that scanner uses. Allows in depth scan.

Application Scanning:

Specific scanning method to identify app vulnerabilities. Evaluates code/behavior of individual apps.

- Static analysis: checks on code without running the app
- Dynamic: analysis while the application is running.

Threat Intelligence

Threat Feeds: real time info about threats and vulnerabilities from multiple sources. Assist with targeting remediation efforts and security controls.

Open Source Intelligence OSINT

Publicly available info

Proprietary/Closed sources

Research and data available as a paid subscription to commercial platforms.

Information Sharing Orgs:

Groups that specialize in exchanging data about emerging threats.

Dark Web/Deep Web

Deep web any part of web not indexed by search engines

Dark net

Network that overlays traditional internet

Requires specialized software to access.

Typically offers anonymous usage

Dark web

Site and content accessible only on dark net. Should know specific URLs. Can provide valuable research information. Not only for illegal activity.

Other Identification Methods

Pentest: legal attempt of breaching organizations networks.

More in depth vulnerability scanning, demonstrates impact.

Three types: Black Box (unknown environment), White box (know environment), grey box

Audits: examine code, features

Bug Bounties programs

Orgs offer incentives for vulnerability discovery and reporting. Public program to attack individuals. Responsible disclosure: program established to encourage vulnerability reporting. Guidelines for how to report.

## Vulnerability Analysis

Common Vulnerabilities and Exposures CVE: developed and operated by MITRE. Identify, define, catalog publicly disclosed vulnerability.

CVE Record ex: CVE-YYYY-####. This CVEs feeds the NVD National Vulnerability Database run by NIST.

CVSS Common Vulnerability Scoring System: standard for assigning scores to vulnerabilities. Based on characteristics of vulnerability. Severity Levels:

- Non - 0
- Low - 0.1 - 3.9
- Medium -4.0 - 6.9
- High - 7.0 - 8.9
- Critical - 9.0 -10

Processing Vulnerabilities:

Identify false positives: items defined as vulnerabilities but aren't.

False Negatives: vulnerabilities do exist but the scanner does not detect those.

Prioritization: Highest severity, most critical software, highest risk to org, ease to exploit.

Analysis Considerations:

Vulnerability Classification: types of system affected, nature of vulnerability, impact to org.

Exposure Factor: how much would assets be affected by compromise or vulnerability exploit?

Impacts: how would the org be affected by vulnerability being exploited?

Environmental Variables: difference in each network that could affect impact.

Organizational Risk Tolerance

## Response and Remediation

Remediation:

- Patching: standard updates and security patches to software and devices. Fixes known vulnerabilities to prevent exploitation.
- Cybersecurity insurance: it can assist with the cost of a breach.
- Segmentation: divide the network to logical or physical portions to mitigate an attack.
- Compensating controls: additional layer to the defense in depth, by extra monitoring, encrypting, authentication, etc.
- Exceptions and exemptions: used when vulnerabilities cannot be remediated for various reasons. Cost too high to warrant mitigation.

Validate Remediations: make sure the efforts to mitigate were successful. Checks for additional vulnerabilities introduced by the previous fix. Do auditings and verifications with Pentest.

Reporting: record of what vulnerabilities were found and how to be addressed. Use CVSS scores. Identify potential impact of each vulnerability.

## Monitoring Systems

Infrastructure monitoring: monitoring the IT infrastructure. Ensure that the systems are working properly. Netflow can assist in detecting malicious behaviors.

Systems and application monitoring:

System Monitors: information reported vía software installed or SNMP. Event Logs, many logs correspond to user activity.

Application Monitoring: numerous thor party solutions to monitor apps. Cloud providers offer their own.

Logging and monitoring activities:

- log aggregation: taking from multiple sources and combining into one location. Normalization converts logs into one common format. Allow correlations and analysis.

Response and reporting: two primary responses to alert in a SIEM.

Validation: true positive, false positive

Quarantine: isolate source of malicious indicator device, file, IP,etc.

Reporting helps provide insight into security controls and their effectiveness.

Archiving: keeping reports for historical use.

Alert Tuning: alerts are generating the proper alerts and reduce the false positives. Eliminate the alert fatigue but be careful as it can increase the false negatives.

## Logging and Monitoring Tools

SIEM: backbone of a logging and monitoring system. Collect data from devices across infrastructure. One point of management, analysis and investigation.

Benchmarks: monitoring systems can scan and compare against benchmarks public, standard or internal.

Contributing Tools: vulnerability scanners, antivirus, data loss prevention DLPs.

## Securing with Firewalls

Firewall rules: define how a firewall should handle inbound/outbound traffic. Rules implemented using ACLs Access control list. Implicit deny at bottom of list, it will block traffic if not other rule matches. Rules can be based on IP, Ports, Protocol, App, etc.

Recommendations: block all inbound requests from private IP Addresses. Block protocols only used on internal networks. Test rules to see if they are functioning the way they should.

Screened Subnet: separate public facing servers from restricted internal network. Uses two firewalls placed at different network locations.

- Edge firewall: connected between public internet and screened subnet.
- Internal Firewall connects between screened subnet and internal network.

## Intrusion Detection and Prevention Systems

IDS/IPS: similar capabilities when detecting threats, IPS only detect and alert, IPS takes action besides alerts. Can be both host based or network based. Implementing both is recommended.

Examples: Snort, Suricata, Security Onion

Detection Methods:

- Signature-based detection/pattern matching.
- Behavioral and anomaly based.
- Trend Analysis

## Security Protocol Implementation

None of the protocols at the beginning were implemented for security only for functionality. Secure protocols are usually more complicated to configure. Involves getting a certificate and installed key. The type of data is important for the selection of the protocol. Port configuration depends on the protocol.

TLS Transport Layer Security: SSL developed in the 1990s to secure HTTP traffic. SLL is no longer secure. Previous TLS versions allow downgrades for legacy clients. TLS 1.3 current and does not permit downgrading.

Directory Service:

![](Security+%20Notes/image12.png)

SNMP:

![](Security+%20Notes/image5.png)

File Transfer:

![](Security+%20Notes/image6.png)

## Network Access Control NAC

Authenticate and authorize a device to access the network. Also has the ability to comply with security policies. Can build profiles for users and devices. It can do dynamic VLAN for device isolation and posturing.

NAC Methods:

- Agent Based: software installed on devices communicates with the NAC platform. Provides more functionality than agentless
- Agentless: port based access controls, network scanner to evaluate device. Can connect with any device that connects to the network.

## DNS Filtering

Checks DNS request against database of Domains. Benefits are effective proactive control. Block access to known phishing and malware sites. Protects all devices on the network without needing client/agent/ Cost Effective, simple setup and config.

Implementation Options: Third party vendors, DNS server configuration, DNS firewall, Open Source Options

DNS Security: Organization DNS servers should only accept queries from local hosts.

Controls to prevent unauthorized records/configuration changes. Disable zone transfers.

DNSSEC DNS Security Extensions

![](Security+%20Notes/image11.png)

# Domain 4: Security Operations II

## Endpoint Security Methods

Antivirus: signature based detection: not good enough as only means of detection. Provide general malware protection

EDR Endpoint detection and response: designed to detect and take action on malware execution. Provides real time historical visibility into compromise.

Operating System security: applies to servers and workstations. Multiple control methods like access controls and authentication methods. App security, secure coding, etc. User awareness training.

Group Policy: windows centralized management/configuration with Active directory. Enforce security settings.

SELinux: security feature in Linux kernel for access control policies.

File Integrity Monitoring: Designed to protect system files against unauthorized modifications. It does it by hashing and matching authorized versions. System File Checker SFC can manually verify.

User Behavior Monitoring: UBA user behavior analytics. Monitor and analyze behavior of users. Designed to detect potential security anomalies. Establish a baseline of what normal behavior is.

## Email Security

It was never built to be secure. There are methods to verify sender and integrity of messages.

- SPF Sender Policy Framework: provides a method to authenticate sender. Helps prevent address forgery. Verifies IP against list of approved IPs. DNS TXT record.
- DKIM DomainKeys Identified Email: method to digitally sign all emails from domain. Provides authentication and integrity check. Uses public key cryptography
- DMARC Domain Based Message Authentication, Reporting & Conformance: DNS Record, instructions for the receiving server what to do after checking SPF and DKIM.

Email Security Gateway: Spam filtering (inbound and outbound)

## Web Filtering

Blocks malicious or inappropriate websites. Analyze web traffic in real time to restrict based on various criterias. ScANNING CAN BE AGENT BASED OR PROXY BASED.

Agent Based Filtering: Software installed on endpoint that accesses websites. All filtering occurs locally on the device.

Centralized Filtering: central proxy based filtering. Intermediate server between endpoint and websites does not require any software on the endpoints.

Filtering Methods:

- URL Scanning
- Content Categorization
- Reputation Based.
- Rules

![](Security+%20Notes/image8.png)

## Identity & Access Management

Account Management: account provisioning, new employees, stakeholders. Should use standard procedures or best practices.

Identity Proofing: verify an individual is who they say they are, usually using some form of official documentation.

Issue Credentials: username, temporary passwords, MFA.

Permissions assignment: RBAC, attribute based, mandatory.

Training: general security awareness training.

Deprovision of accounts when they are no longer needed or when any permission is not needed anymore.

All accounts and access should follow least privilege.

Continual monitoring of rights to eliminate authorization creep.

## Federation and Single Sign- On

Directory Services: Most based on LDAP Lightweight Directory Access Protocol.

![](Security+%20Notes/image17.png)

Single Sign On SSO: allows authentication using single identity. Most common SSO protocol is Kerberos.

Kerberos: Key Distribution Center KDC. Authenticates principles and issues tickets. Consists of authentication service and TGS Ticket Granting Service.

![](Security+%20Notes/image16.png)

Federation: Network resources need to be accessible by more than just employees. Federation let Orgs create a “trust” account managed by a different network, allowing identity sharing across boundaries.

SAML Security Assertion Markup Language

Allow single login to gain access to multiple web based systems. Written in XML. Shares authentication and authorization information.

![](Security+%20Notes/image9.png)

OAUTH: Open standard that allows authorization across third parties.

![](Security+%20Notes/image1.png)

## Access Control Methods

Different ways that permissions can be assigned to users.

Discretionary Access Control DAC: users directly own file/resources. Have full permission to those resources. Can assign to other users permissions. Uses access control lists ACLs. Used by the majority of OS. Risk of abuse.

Mandatory Access Control MAC: users do not have discretion to control access rights. Much more secure than DAC, built around using security labels/classifications. Subjects only permitted access to objects at their clearance level.

Role-Based Access Control RBAC: Centrally administered manner of providing access. Based around job duties and responsibilities. Permissions are assigned to that role, users assigned directly to that role. Eases administrations and management. Roles can be stacked in hierarchies.

Attribute based access control ABAC: very fine grained access control model. Access decision based on combination of subject/object attributes. Capable of monitoring number and severity of alerts for users/devices. Can track requests to ensure time and geography.

Rule based access control: AC model where policies determined by system enforced rules. Conditional Access can monitor system behavior throughout sessions.

Restrictions: additional methods to mitigate risk of account compromise. Location based policies. Time based restrictions.

## Multi Factor Authentication MFA

Two or more forms of authentication to verify identity of the users. Hardware and software implementations.

Authentication factors: something you know, have, are, somewhere you are.

MFA Implementations:

- Soft Tokens: one code generated and sent to the user. SMS or email delivery. App installed on a smartphone. Most convenient from the end user point of view.
- Hard Authentication Token: 3 types, certificate based, OTP one time password, FIDO fast identity online and universal 2nd factor U2F.
    - Smart Cards
    - OTP: generate a token
    - Security Key: usb,nfc,portable HSM
- Biometric: Enrollment (sample of the biometric required.)
    - FRR false rejection rate, % of the time that the user is not recognized.
    - FAR False acceptance rate, % when a non auth is allowed

## Password

Password Length: minimum and maximum length of the password.

Complexity: special characters requirements.

Password reuse: using the same password for multiple services

Password Manager: secure way to manage and store passwords. Secure with a Master Password. Allow randomly generated passwords. Must be secure and encrypted. Still some risk that passwords can be compromised.

Passwordless Authentication: eliminates the use of something you know auth. Uses roaming authenticator or platform authenticator.

## Privileged Access Management

Accounts with elevated access are always needed. Not owned by one specific person. Coupled with other security controls like MFA.

Just in time JIT access: methods to provision elevated access on demand. 3 Models:

- Temporary Elevation
- Password vaulting
- Ephemeral Credentials

## Automation and scripting

Multiple uses for automation, like streamline processes, security control implementations. Enables consistent and efficient enforcement. Monitoring and reporting benefits.

Capabilities of Automation:

- user and system/resources provisioning and deprovisioning.
- Ticketing platform
- Service Management
- Continuous integration and testing
- APIs Application programming interfaces

Automation Benefits and Considerations

Benefits

- Enhanced efficiency and time saving, reduce human error
- Improved detection and reaction times
- Enforcement of standardized baselines
- Automatic system deployment and scaling

Considerations

- Complexity
- Expensive
- Single point of failure
- Technical debt due to improper implementation
- Ongoing Support

## Incident Response Process

Incident is any sort of attempt to compromise the environment. It is needed to have a process, resources and guidelines to deal with incidents.

Incident Life Cycle:

- Preparation: Establish infrastructure that supports the entire process. Incident response team should be in place. A Communication Plan should be established ahead of time. Stakeholder management with NDA. This creates an Incident Response Plan IRP.
- Detection: Event correlation and analysis to determine evidence of incident. There are multiple methods to determine.
- Analysis: investigation to determine if an actual incident or false positive. Identify the type of incident and affected resources. What data is at risk? Is there any downtime and what is the economic impact? What was the scope?
    - Detection time
    - Recovery Time

Threat intelligence required for effective analysis

Cyber Kill Chain

- Reconnaissance
- Weaponization
- Delivery
- Exploitation
- Installation
- Common and control
- Actions and Objectives
- Containment: no standard approach depends on the situation and the attack.
    - Isolation based containment: makes the infection not able to be spread.
    - Segmentation Based containment: isolation of a complete network
- Eradication: Apply mitigation and other controls to remove intrusion.
- Recovery: Restore any affected systems to remove any traces of incident. Restore any accounts. Audit all security controls. Notified all affected parties.
- Lessons Learned: review incident to determine cause whether avoidable and how to avoid it. Typically involves meeting with all personnel involved in IR.

## Incident Response Training and testing

Incident detection training and reporting procedures, enables the responder to act quickly and effectively. Incident response typically involves multiple teams/departments. All training should not be technical in nature. Lessons learned often show opportunities for additional training.

Tabletop Exercise: Training involving scenarios. Normally does not use computer systems. Least cost effective.

Simulations: more expensive to implement. Typically team based exercise. Done on non production environments. Red Team/Blue team.

## Digital Forensics

Collecting evidence from computer systems. To be used in court of law.

Due process: set of procedures to ensure fairness. Legal hold any information on hold must be preserved.

Chain of Custody: documentation that verifies integrity and proper handling of evidence, designed to protect the org. Maintaining and updating throughout the entire process.

Acquisition: acquire the data to obtain forensically clean data. Required also that data can be legally seized/searched. It can be trickier on BYOD devices. It has an order of volatility that is when the data can be deleted based on how volatile is.

E-discovery: filtering all data collected to find relevant evidence. Data is securely stored in a way that can be used as evidence. It can be automated by using software tools.

Maintaining Data: evidence preservation, by access to evidence tightly controlled. Integrity and non repudiation should be taken into account by using hashes.

Reporting: summary of data collected and conclusions from analysis. Requires strong ethical principles for it to not be biased. Devices may need to be manipulated to perform analysis in some cases.

## Log Data

Data sources and dashboards: IR requires data sources to discover indicators. SIEM tools are used to aggregate and correlate data from multiple sources. Event dashboards starting console for day to day IR.

Operating System Logs

- Windows:
    - application logs: generated by app process, crashes, installs, removals
    - Security logs: audit events (failed/successful logins, access allowed/denied)
    - System logs: generated by kernel process (service startup and shutdown)
- Linux: logging differs by distribution.

![](Security+%20Notes/image2.png)

- MacOS: unified logging system, accessible through console app or log command.

Application and Endpoint Logs

Application logs: generated by application rather than OS.

Endpoint logs: typically generated by endpoint security software.

Summary of events can show overall security/threat level

Vulnerability scans.

Network Logs

Events generated by switches,routers,firewalls,etc.

Firewall logs: can result in a large number of logs.

IPS/IDS logs generated when traffic matches rules.

Packet capture used to analyze frame by frame information of traffic.

Metadata:

Properties about data/logs

# Domain 5: Security Program Management and Oversight

## Policies

Builds a framework for operations, behaviors, compliance rules,etc. Policies are used for governance of the org. Also compliance and guidelines.

Common Policies:

- Acceptable use policies AUP: defines what employees may or may not do with company systems. The goal is to ensure users do not harm organization or resources.
- Information Security Policies: ensure all IT users comply with rules and guidelines.
- Business Continuity BC and continuity of operations plans COOP: details critical business process that must stay operational
- Disaster Recovery DR: details of steps to recover from an event.
- Incident Response IR: steps to follow during a security breach.
- Software Development Lifecycle SDLC: structured plan to detail stages of software development.
- Change Management: how changes to systems and software are performed.

## Procedures

Personnel Management: Policies and procedures related to identity and access management. Cooperation between IT and HR. It starts with the process of recruitment, then Operations and ends with the Separation.

Onboarding and Offboarding

Onboarding behind with HR bringing in new employees. All new employees require access to resources. Integration between HR and IT can make the process more efficient/secure. Includes proper training and security awareness.

Offboarding is the opposite and comes when personnel are leaving and decommission of access is required.

Playbooks: checklist of what a person needs to do for a specific workflow. Assist with sharing information with new employees. This ensures consistency, quality and effectiveness. Allows for effective monitoring and improvement of procedures .

Change Management: any change requires careful planning. Including how the change will affect other systems and processes. Significant changes require testing before implementation. All changes should include rollback plans. Change management documentation is important before the procedures go.

## Standards

Define what should be expected from an outcome of a certain activity or task. Often driven by regulatory requirements. Also they are built around risk management. This involves strategic planning.

## Common Industry Standards

- ISO/IEC 27001 and 27002: Framework for security controls. The 27002 gives more detailed guidance on specific control
- ISO/IEC 77017 and 27018: extension for cloud services and PII in cloud.
- NIST SP 800-63: US Govt standard for digital identities, password and access control reqs.
- PCI DSS: requirements for handling and protecting credit card information.
- FIPS: standards for federal computer systems.

Passwords: technical requirements for design, implementation and management. Also which hashing algorithm should be used and password salting. Secure transmission and password resets, and password managers.

Access Control: ensure only authorized users can access data/systems. Identity verification, privilege management, authentication protocols, session management, audit trails.

Physical Security: protecting hardware and places. Building security. Workstation security. Room security and equipment disposal. Visitor control.

Encryption: Protecting data from unauthorized access. Encryption algorithms are acceptable. Key length for each algorithm. Key management.

## Laws and Regulations

Legal Considerations: Multiple regulations and laws must be considered in security. Vary based on industry and locations. Several frameworks and benchmarks exist to assist. Due diligence is required meaning that they are responsible parties that have done everything they can.

Global Laws: many locations have enacted wide reaching laws. Ex GDPR, CCPA

National, Regional and Industry Laws: countries/regions have laws that apply to various industries. Most cybersecurity laws have national/international scope

## Governance

Practices to ensure organizations follow regulations and laws. Designed to protect from legal liability. Oversight on multiple legal risks. Policies require constant update and revisions to stay compliant.

Governance Boards: senior executives and external stakeholders.

Governance committees: subject matter experts providing analysis and recommendations.

Centralized and decentralized governance:

- Centralized: single core group/department primarily responsible
- Decentralized: multiple groups assuming responsibility.

Government Entities

- Governmental governance committees based on country/jurisdiction
- Regulatory agencies
- Intelligence agencies
- Law enforcement
- Defense/military organizations
- Data protection authorities

Data Governance: Relies on various roles to maintain security oversight and control.

- Data Owner: responsible for ensuring data is protected. Identifies classification/sensitivity.
- Data Controller: ensures data processing adhere to all legal requirements
- Data Processor: responsible for processing data on behalf of the controller.
- Data Custodian: responsible for safe storage and transport of data. They should implement all the controls established by the controller and owner.

## Risk Identification and assessment

Risk Identification: first step in any risk assessment/analysis process.

- Technical Risk
- Non technical Risk
- Multiple methods to identify

Risk Assessment: evaluation of identified risk to determine potential impact.Some types of assessment: Ad-Hoc, one-time, recurring, continuous

## Risk Analysis

Process of identifying and evaluating potential risks. Evaluate nature, cause, consequence and concern of the risk.

Risk assessment

What is the likelihood of any given threat occurring.

Quantitative Risk Analysis: Assigns specific values to risk factors. Exposure Factor EF, Annualized rate of occurrence ARO, single loss expectancy SLE, Annualized loss expectancy ALE. Values not only refer to monetary or material value.

Qualitative Risk Analysis: assessment based on subjective judgment instead of precise numbers. More accessible method. It can be subjective, can introduce bias and be more difficult to present without concrete numbers.

Risk Register: document that shows results of risk assessment. Heat map risk matrix. Scatter Plot Graph includes information about the nature of risk.

Key Risk Indicators KPIs: predictive indicators used to monitor and predict potential risk. Risk Appetite: level of risk organization is willing to accept.

## Risk Management

Managing Risk: risk cannot be eliminated only mitigated to a minimum level.

Risk Management Process

- Identify critical business functions
- Identify vulnerabilities
- Identify Threats
- Analyze business impacts
- Identify risk response

Accept Risk: level of the risk that does not justify to perform any action.

- Risk Exception: cannot be mitigated.
- Risk Exemption: risk can remain without being mitigated

Transfer Risk: also known as risk sharing. Assign the risk to a third party like an insurance company. Some risk cannot be transferred or shared.

Avoid Risk: stopping whatever activity that is creating the risk.

Mitigating Risk: action to reduce the risk

## Business Impact Analysis BIA

What losses might occur in various scenarios: financial, operational, reputational.

Identify Critical Business Components

Critical System Identification like people, physical assets, intangible, procedures.

MEF Metrics

- Maximum tolerable downtime MTD, longest time function can be interrupted before unrecoverable business failure.
- Recovery time objective RTO: period of time after an incident that system may remain offline
- Work Recovery Time WRT: after recovery additional time to fully support functions
- Recovery point objective RPO: amount of data loss a system can sustain.

Reliability Measurements

- Mean Time between failures MTBF: expected lifetime of product.
- Mean time to repair MTTR: amount of time taken to restore the system to full operation.

Higher MTBF shows greater reliability and longer time between failures.

## Vendor Selection and Assessment

Vendors: Any external person that provides services, goods, etc to org. Selection involves multiple steps. Assessment is a critical part of the selection process. Avoid conflict of interest

Assessment methods to chose the vendor:

- Through investigation and evaluation
- Pentest
- Right to audit clause
- Evidence of internal audits
- Independent Assessments
- Supply chain analysis
- Continuous monitoring and evaluations

## Vendor Agreements

Relationship with vendors based on services provided.

- Memorandum of understanding MOU. non binding agreement
- Memorandum of Agreement MOA. binding agreement
- Non Disclosure Agreement NDA: ensures confidentiality
- Business Partnership Agreement BPA: long term partnership between organizations, usually includes goals.
- Master Service Agreement MSA; overall terms and conditions

Detailed Agreement:

- Service Level Agreement SLA: defines metrics and standards expected from vendors.
- Statement of work SOW: details a specific project or engagement.
- Questionnaires: information about vendors' security practices.

Rules of Engagement RoE: define parameters and expectations.

## Compliance Monitoring and Reporting

Ensure organization is adhering to legal/regulatory requirements. Attestation and acknowledgement and business partners. Performed internally and by third parties.

Reporting: provides proof of compliance with laws and regulations. Both internal and external reporting are required.

- Internal: for internal stakeholders.
- External: targets external stakeholders

## Non-Compliance Consequences

Data Breaches: occurs when any data is accessed without authorization. Can cause reputational damage, fines and the loss of intellectual property

Non Compliance: consequences vary by jurisdiction, industry and regulations.

Contractual noncompliance: breach of contract by failing to meet any obligations in contact may lead to legal consequences. Termination of contract, contracts typically include clauses allowing termination.

## Privacy

Any sensitive data that relates to an individual that can be personally identifiable information

Data subjects have the right to access, correct and request deletion of data.

Private Data Ownership: data protection laws focus on the data subject and not the owner. The subjects have the right to be forgotten.

Data Inventory: some laws require detailed record of data collected, processed and stored. Data can only be kept as long as necessary for intended purposes.

Legal Implications: national laws enforced by data protection authorities/supervisory bodies. There are global laws/regulations.

Roles and responsibilities:

- Data Subject: individual identified by the personal data
- Data controller: entity or org that determines how and why data is processed.
- Data processor: process data on behalf of the controller.

## Audits and Assessments

Attestations: verification and validation of security controls and processes.

Internal Audits: in-depth evaluation by organizations employees.

External Audits: performed by outside, third party providers and should be impartial.

## Penetration Testing

Ideally designed to replicate an attack by a threat actor. Authorized engagement. More in depth than normal vulnerability scans. By definition it is an intrusive test.

Reconnaissance: Provides information to help testers understand targets.

- Passive: information obtained without direct interaction.
- Active: use tools to interact with the target systems and gather information.

Testing Methods: Blackbox, whitebox, graybox

Exercise Types

- Offensive Red team
- Defensive Blue team
- Integrated Purple team

Physical Pen Testing: assesses organizations physical security controls and practices.

## User Training

All employees need security awareness training. Overview of security policies and penalties.

Security Awareness Training Topics: policies and handbooks, situational awareness, insider threat, password management, removable media and cables, social engineering,operational security.

Recognizing suspicious behavior: anomalous behavior, risky behavior, unexpected behaviors, unintentional behaviors.

## Training Development and Execution

Assessment of what the organization needs training on. Planning and design objectives, topics, delivery methods of training. Development of the training content. Delivery and implementation, evaluation and feedback of how effective it was.
